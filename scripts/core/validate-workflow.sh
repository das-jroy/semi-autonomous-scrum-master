#!/bin/bash
# Workflow Validation Script

echo "âœ… Workflow Validation"
echo "====================="
echo ""

# Check workflow status distribution
echo "ðŸ“Š Workflow Status Distribution:"
echo "Note: GitHub Projects v2 uses custom Status field instead of labels"
echo "â€¢ All new issues start in 'Todo' status by default"
echo "â€¢ Status changes are tracked through the project board"
echo ""

# Get general issue counts by type
echo "ðŸ“‹ Issue Categories:"
total_modules=$(gh issue list --repo dasdigitalplatform/vanguard-az-infraweave-catalog --state open --label "module" --limit 100 --json number | jq length)
total_docs=$(gh issue list --repo dasdigitalplatform/vanguard-az-infraweave-catalog --state open --label "documentation" --limit 100 --json number | jq length)
total_infra=$(gh issue list --repo dasdigitalplatform/vanguard-az-infraweave-catalog --state open --label "infrastructure" --limit 100 --json number | jq length)

echo "â€¢ Module implementation: $total_modules issues"
echo "â€¢ Documentation: $total_docs issues"  
echo "â€¢ Infrastructure: $total_infra issues"
echo ""

# Workflow health based on issue distribution
echo "ðŸš¦ Workflow Health Check:"
if [ "$total_modules" -gt 10 ]; then
    echo "ðŸ“ˆ Active Development: $total_modules module issues ready for work"
else
    echo "âœ… Focused Development: $total_modules module issues in backlog"
fi

echo "âœ… Workflow Status: Ready for development"
echo "ï¿½ Use the project board to move issues through workflow stages"

echo ""
echo "ðŸ”— Quick Actions:"
echo "â€¢ Sprint Board: https://github.com/orgs/dasdigitalplatform/projects/3/views/4"
echo "â€¢ Priority View: https://github.com/orgs/dasdigitalplatform/projects/3/views/1"
echo "â€¢ Run Health Check: ./scripts/check-view-health.sh"
